define(["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.createConfigDropdown = (sandbox, monaco) => {
        const configContainer = document.getElementById('config-container');
        const container = document.createElement('div');
        container.id = 'boolean-options-container';
        configContainer.appendChild(container);
        const compilerOpts = sandbox.getCompilerOptions();
        const boolOptions = Object.keys(compilerOpts).filter(k => typeof compilerOpts[k] === 'boolean');
        // we want to make sections of categories
        const categoryMap = {};
        boolOptions.forEach(optID => {
            const summary = optionsSummary.find(sum => optID === sum.id);
            const existingCategory = categoryMap[summary.categoryID];
            if (!existingCategory)
                categoryMap[summary.categoryID] = {};
            categoryMap[summary.categoryID][optID] = summary;
        });
        Object.keys(categoryMap).forEach(categoryID => {
            const categoryDiv = document.createElement('div');
            const header = document.createElement('h4');
            const ol = document.createElement('ol');
            Object.keys(categoryMap[categoryID]).forEach(optID => {
                const optSummary = categoryMap[categoryID][optID];
                header.textContent = optSummary.categoryDisplay;
                const li = document.createElement('li');
                const label = document.createElement('label');
                label.innerHTML = `<span>${optSummary.id}</span><br/>${optSummary.oneliner}`;
                const input = document.createElement('input');
                input.value = optSummary.id;
                input.type = 'checkbox';
                input.name = optSummary.id;
                input.id = 'option-' + optSummary.id;
                input.onchange = () => {
                    sandbox.updateCompilerSetting(optSummary.id, input.checked);
                };
                label.htmlFor = input.id;
                li.appendChild(input);
                li.appendChild(label);
                ol.appendChild(li);
            });
            categoryDiv.appendChild(header);
            categoryDiv.appendChild(ol);
            container.appendChild(categoryDiv);
        });
        const dropdownContainer = document.getElementById('compiler-dropdowns');
        const target = optionsSummary.find(sum => sum.id === 'target');
        const targetSwitch = createSelect(target.display, 'target', target.oneliner, sandbox, monaco.languages.typescript.ScriptTarget);
        dropdownContainer.appendChild(targetSwitch);
        const jsx = optionsSummary.find(sum => sum.id === 'jsx');
        const jsxSwitch = createSelect(jsx.display, 'jsx', jsx.oneliner, sandbox, monaco.languages.typescript.JsxEmit);
        dropdownContainer.appendChild(jsxSwitch);
        const modSum = optionsSummary.find(sum => sum.id === 'module');
        const moduleSwitch = createSelect(modSum.display, 'module', modSum.oneliner, sandbox, monaco.languages.typescript.ModuleKind);
        dropdownContainer.appendChild(moduleSwitch);
    };
    exports.updateConfigDropdownForCompilerOptions = (sandbox, monaco) => {
        const compilerOpts = sandbox.getCompilerOptions();
        const boolOptions = Object.keys(compilerOpts).filter(k => typeof compilerOpts[k] === 'boolean');
        boolOptions.forEach(opt => {
            const inputID = 'option-' + opt;
            const input = document.getElementById(inputID);
            input.checked = !!compilerOpts[opt];
        });
        const compilerIDToMaps = {
            module: monaco.languages.typescript.ModuleKind,
            jsx: monaco.languages.typescript.JsxEmit,
            target: monaco.languages.typescript.ScriptTarget,
        };
        Object.keys(compilerIDToMaps).forEach(flagID => {
            const input = document.getElementById('compiler-select-' + flagID);
            const currentValue = compilerOpts[flagID];
            const map = compilerIDToMaps[flagID];
            // @ts-ignore
            const realValue = map[currentValue];
            // @ts-ignore
            for (const option of input.children) {
                option.selected = option.value.toLowerCase() === realValue.toLowerCase();
            }
        });
    };
    const createSelect = (title, id, blurb, sandbox, option) => {
        const label = document.createElement('label');
        const textToDescribe = document.createElement('span');
        textToDescribe.textContent = title + ':';
        label.appendChild(textToDescribe);
        const select = document.createElement('select');
        select.id = 'compiler-select-' + id;
        label.appendChild(select);
        select.onchange = () => {
            const value = select.value; // the human string
            const compilerIndex = option[value];
            sandbox.updateCompilerSetting(id, compilerIndex);
        };
        Object.keys(option)
            .filter(key => isNaN(Number(key)))
            .forEach(key => {
            // hide Latest
            if (key === 'Latest')
                return;
            const option = document.createElement('option');
            option.value = key;
            option.text = key;
            select.appendChild(option);
        });
        const span = document.createElement('span');
        span.textContent = blurb;
        span.classList.add('compiler-flag-blurb');
        label.appendChild(span);
        return label;
    };
    exports.setupJSONToggleForConfig = (sandbox) => { };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQ29uZmlnRHJvcGRvd24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wbGF5Z3JvdW5kL3NyYy9jcmVhdGVDb25maWdEcm9wZG93bi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7SUFhYSxRQUFBLG9CQUFvQixHQUFHLENBQUMsT0FBZ0IsRUFBRSxNQUFjLEVBQUUsRUFBRTtRQUN2RSxNQUFNLGVBQWUsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGtCQUFrQixDQUFFLENBQUE7UUFDcEUsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUMvQyxTQUFTLENBQUMsRUFBRSxHQUFHLDJCQUEyQixDQUFBO1FBQzFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUE7UUFFdEMsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLGtCQUFrQixFQUFFLENBQUE7UUFDakQsTUFBTSxXQUFXLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLFlBQVksQ0FBQyxDQUFDLENBQUMsS0FBSyxTQUFTLENBQUMsQ0FBQTtRQUUvRix5Q0FBeUM7UUFDekMsTUFBTSxXQUFXLEdBQUcsRUFBaUUsQ0FBQTtRQUNyRixXQUFXLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQzFCLE1BQU0sT0FBTyxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBRSxDQUFBO1lBRTdELE1BQU0sZ0JBQWdCLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUN4RCxJQUFJLENBQUMsZ0JBQWdCO2dCQUFFLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFBO1lBRTNELFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFBO1FBQ2xELENBQUMsQ0FBQyxDQUFBO1FBRUYsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7WUFDNUMsTUFBTSxXQUFXLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtZQUNqRCxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFBO1lBQzNDLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUE7WUFFdkMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ25ELE1BQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtnQkFDakQsTUFBTSxDQUFDLFdBQVcsR0FBRyxVQUFVLENBQUMsZUFBZSxDQUFBO2dCQUUvQyxNQUFNLEVBQUUsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUN2QyxNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFBO2dCQUM3QyxLQUFLLENBQUMsU0FBUyxHQUFHLFNBQVMsVUFBVSxDQUFDLEVBQUUsZUFBZSxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUE7Z0JBRTVFLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUE7Z0JBQzdDLEtBQUssQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDLEVBQUUsQ0FBQTtnQkFDM0IsS0FBSyxDQUFDLElBQUksR0FBRyxVQUFVLENBQUE7Z0JBQ3ZCLEtBQUssQ0FBQyxJQUFJLEdBQUcsVUFBVSxDQUFDLEVBQUUsQ0FBQTtnQkFDMUIsS0FBSyxDQUFDLEVBQUUsR0FBRyxTQUFTLEdBQUcsVUFBVSxDQUFDLEVBQUUsQ0FBQTtnQkFFcEMsS0FBSyxDQUFDLFFBQVEsR0FBRyxHQUFHLEVBQUU7b0JBQ3BCLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQTtnQkFDN0QsQ0FBQyxDQUFBO2dCQUVELEtBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQTtnQkFFeEIsRUFBRSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtnQkFDckIsRUFBRSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQTtnQkFDckIsRUFBRSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQTtZQUNwQixDQUFDLENBQUMsQ0FBQTtZQUVGLFdBQVcsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUE7WUFDL0IsV0FBVyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQTtZQUMzQixTQUFTLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1FBQ3BDLENBQUMsQ0FBQyxDQUFBO1FBRUYsTUFBTSxpQkFBaUIsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLG9CQUFvQixDQUFFLENBQUE7UUFFeEUsTUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUssUUFBUSxDQUFFLENBQUE7UUFDL0QsTUFBTSxZQUFZLEdBQUcsWUFBWSxDQUMvQixNQUFNLENBQUMsT0FBTyxFQUNkLFFBQVEsRUFDUixNQUFNLENBQUMsUUFBUSxFQUNmLE9BQU8sRUFDUCxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQ3pDLENBQUE7UUFDRCxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUE7UUFFM0MsTUFBTSxHQUFHLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUssS0FBSyxDQUFFLENBQUE7UUFDekQsTUFBTSxTQUFTLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQzlHLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUV4QyxNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsS0FBSyxRQUFRLENBQUUsQ0FBQTtRQUMvRCxNQUFNLFlBQVksR0FBRyxZQUFZLENBQy9CLE1BQU0sQ0FBQyxPQUFPLEVBQ2QsUUFBUSxFQUNSLE1BQU0sQ0FBQyxRQUFRLEVBQ2YsT0FBTyxFQUNQLE1BQU0sQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FDdkMsQ0FBQTtRQUNELGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQTtJQUM3QyxDQUFDLENBQUE7SUFFWSxRQUFBLHNDQUFzQyxHQUFHLENBQUMsT0FBZ0IsRUFBRSxNQUFjLEVBQUUsRUFBRTtRQUN6RixNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsQ0FBQTtRQUNqRCxNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sWUFBWSxDQUFDLENBQUMsQ0FBQyxLQUFLLFNBQVMsQ0FBQyxDQUFBO1FBRS9GLFdBQVcsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDeEIsTUFBTSxPQUFPLEdBQUcsU0FBUyxHQUFHLEdBQUcsQ0FBQTtZQUMvQixNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBcUIsQ0FBQTtZQUNsRSxLQUFLLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDckMsQ0FBQyxDQUFDLENBQUE7UUFFRixNQUFNLGdCQUFnQixHQUFRO1lBQzVCLE1BQU0sRUFBRSxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxVQUFVO1lBQzlDLEdBQUcsRUFBRSxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxPQUFPO1lBQ3hDLE1BQU0sRUFBRSxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxZQUFZO1NBQ2pELENBQUE7UUFFRCxNQUFNLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQzdDLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsa0JBQWtCLEdBQUcsTUFBTSxDQUFxQixDQUFBO1lBQ3RGLE1BQU0sWUFBWSxHQUFHLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUN6QyxNQUFNLEdBQUcsR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQTtZQUNwQyxhQUFhO1lBQ2IsTUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFBO1lBQ25DLGFBQWE7WUFDYixLQUFLLE1BQU0sTUFBTSxJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUU7Z0JBQ25DLE1BQU0sQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQUUsS0FBSyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUE7YUFDekU7UUFDSCxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUMsQ0FBQTtJQUVELE1BQU0sWUFBWSxHQUFHLENBQUMsS0FBYSxFQUFFLEVBQVUsRUFBRSxLQUFhLEVBQUUsT0FBZ0IsRUFBRSxNQUFXLEVBQUUsRUFBRTtRQUMvRixNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQzdDLE1BQU0sY0FBYyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUE7UUFDckQsY0FBYyxDQUFDLFdBQVcsR0FBRyxLQUFLLEdBQUcsR0FBRyxDQUFBO1FBQ3hDLEtBQUssQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUE7UUFFakMsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQTtRQUMvQyxNQUFNLENBQUMsRUFBRSxHQUFHLGtCQUFrQixHQUFHLEVBQUUsQ0FBQTtRQUNuQyxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBRXpCLE1BQU0sQ0FBQyxRQUFRLEdBQUcsR0FBRyxFQUFFO1lBQ3JCLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUEsQ0FBQyxtQkFBbUI7WUFDOUMsTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQ25DLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFLEVBQUUsYUFBYSxDQUFDLENBQUE7UUFDbEQsQ0FBQyxDQUFBO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7YUFDaEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2FBQ2pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNiLGNBQWM7WUFDZCxJQUFJLEdBQUcsS0FBSyxRQUFRO2dCQUFFLE9BQU07WUFFNUIsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQTtZQUMvQyxNQUFNLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQTtZQUNsQixNQUFNLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQTtZQUVqQixNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1FBQzVCLENBQUMsQ0FBQyxDQUFBO1FBRUosTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUMzQyxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQTtRQUN4QixJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO1FBQ3pDLEtBQUssQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUE7UUFFdkIsT0FBTyxLQUFLLENBQUE7SUFDZCxDQUFDLENBQUE7SUFFWSxRQUFBLHdCQUF3QixHQUFHLENBQUMsT0FBZ0IsRUFBRSxFQUFFLEdBQUUsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsidHlwZSBTYW5kYm94ID0gaW1wb3J0KCd0eXBlc2NyaXB0LXNhbmRib3gnKS5TYW5kYm94XG50eXBlIE1vbmFjbyA9IHR5cGVvZiBpbXBvcnQoJ21vbmFjby1lZGl0b3InKVxuXG50eXBlIE9wdGlvbnNTdW1tYXJ5ID0ge1xuICBkaXNwbGF5OiBzdHJpbmdcbiAgb25lbGluZXI6IHN0cmluZ1xuICBpZDogc3RyaW5nXG4gIGNhdGVnb3J5SUQ6IHN0cmluZ1xuICBjYXRlZ29yeURpc3BsYXk6IHN0cmluZ1xufVxuXG5kZWNsYXJlIGNvbnN0IG9wdGlvbnNTdW1tYXJ5OiBPcHRpb25zU3VtbWFyeVtdXG5cbmV4cG9ydCBjb25zdCBjcmVhdGVDb25maWdEcm9wZG93biA9IChzYW5kYm94OiBTYW5kYm94LCBtb25hY286IE1vbmFjbykgPT4ge1xuICBjb25zdCBjb25maWdDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29uZmlnLWNvbnRhaW5lcicpIVxuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICBjb250YWluZXIuaWQgPSAnYm9vbGVhbi1vcHRpb25zLWNvbnRhaW5lcidcbiAgY29uZmlnQ29udGFpbmVyLmFwcGVuZENoaWxkKGNvbnRhaW5lcilcblxuICBjb25zdCBjb21waWxlck9wdHMgPSBzYW5kYm94LmdldENvbXBpbGVyT3B0aW9ucygpXG4gIGNvbnN0IGJvb2xPcHRpb25zID0gT2JqZWN0LmtleXMoY29tcGlsZXJPcHRzKS5maWx0ZXIoayA9PiB0eXBlb2YgY29tcGlsZXJPcHRzW2tdID09PSAnYm9vbGVhbicpXG5cbiAgLy8gd2Ugd2FudCB0byBtYWtlIHNlY3Rpb25zIG9mIGNhdGVnb3JpZXNcbiAgY29uc3QgY2F0ZWdvcnlNYXAgPSB7fSBhcyB7IFtjYXRlZ29yeTogc3RyaW5nXTogeyBbb3B0SUQ6IHN0cmluZ106IE9wdGlvbnNTdW1tYXJ5IH0gfVxuICBib29sT3B0aW9ucy5mb3JFYWNoKG9wdElEID0+IHtcbiAgICBjb25zdCBzdW1tYXJ5ID0gb3B0aW9uc1N1bW1hcnkuZmluZChzdW0gPT4gb3B0SUQgPT09IHN1bS5pZCkhXG5cbiAgICBjb25zdCBleGlzdGluZ0NhdGVnb3J5ID0gY2F0ZWdvcnlNYXBbc3VtbWFyeS5jYXRlZ29yeUlEXVxuICAgIGlmICghZXhpc3RpbmdDYXRlZ29yeSkgY2F0ZWdvcnlNYXBbc3VtbWFyeS5jYXRlZ29yeUlEXSA9IHt9XG5cbiAgICBjYXRlZ29yeU1hcFtzdW1tYXJ5LmNhdGVnb3J5SURdW29wdElEXSA9IHN1bW1hcnlcbiAgfSlcblxuICBPYmplY3Qua2V5cyhjYXRlZ29yeU1hcCkuZm9yRWFjaChjYXRlZ29yeUlEID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKVxuICAgIGNvbnN0IG9sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb2wnKVxuXG4gICAgT2JqZWN0LmtleXMoY2F0ZWdvcnlNYXBbY2F0ZWdvcnlJRF0pLmZvckVhY2gob3B0SUQgPT4ge1xuICAgICAgY29uc3Qgb3B0U3VtbWFyeSA9IGNhdGVnb3J5TWFwW2NhdGVnb3J5SURdW29wdElEXVxuICAgICAgaGVhZGVyLnRleHRDb250ZW50ID0gb3B0U3VtbWFyeS5jYXRlZ29yeURpc3BsYXlcblxuICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXG4gICAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJylcbiAgICAgIGxhYmVsLmlubmVySFRNTCA9IGA8c3Bhbj4ke29wdFN1bW1hcnkuaWR9PC9zcGFuPjxici8+JHtvcHRTdW1tYXJ5Lm9uZWxpbmVyfWBcblxuICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgICBpbnB1dC52YWx1ZSA9IG9wdFN1bW1hcnkuaWRcbiAgICAgIGlucHV0LnR5cGUgPSAnY2hlY2tib3gnXG4gICAgICBpbnB1dC5uYW1lID0gb3B0U3VtbWFyeS5pZFxuICAgICAgaW5wdXQuaWQgPSAnb3B0aW9uLScgKyBvcHRTdW1tYXJ5LmlkXG5cbiAgICAgIGlucHV0Lm9uY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICBzYW5kYm94LnVwZGF0ZUNvbXBpbGVyU2V0dGluZyhvcHRTdW1tYXJ5LmlkLCBpbnB1dC5jaGVja2VkKVxuICAgICAgfVxuXG4gICAgICBsYWJlbC5odG1sRm9yID0gaW5wdXQuaWRcblxuICAgICAgbGkuYXBwZW5kQ2hpbGQoaW5wdXQpXG4gICAgICBsaS5hcHBlbmRDaGlsZChsYWJlbClcbiAgICAgIG9sLmFwcGVuZENoaWxkKGxpKVxuICAgIH0pXG5cbiAgICBjYXRlZ29yeURpdi5hcHBlbmRDaGlsZChoZWFkZXIpXG4gICAgY2F0ZWdvcnlEaXYuYXBwZW5kQ2hpbGQob2wpXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNhdGVnb3J5RGl2KVxuICB9KVxuXG4gIGNvbnN0IGRyb3Bkb3duQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXBpbGVyLWRyb3Bkb3ducycpIVxuXG4gIGNvbnN0IHRhcmdldCA9IG9wdGlvbnNTdW1tYXJ5LmZpbmQoc3VtID0+IHN1bS5pZCA9PT0gJ3RhcmdldCcpIVxuICBjb25zdCB0YXJnZXRTd2l0Y2ggPSBjcmVhdGVTZWxlY3QoXG4gICAgdGFyZ2V0LmRpc3BsYXksXG4gICAgJ3RhcmdldCcsXG4gICAgdGFyZ2V0Lm9uZWxpbmVyLFxuICAgIHNhbmRib3gsXG4gICAgbW9uYWNvLmxhbmd1YWdlcy50eXBlc2NyaXB0LlNjcmlwdFRhcmdldFxuICApXG4gIGRyb3Bkb3duQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhcmdldFN3aXRjaClcblxuICBjb25zdCBqc3ggPSBvcHRpb25zU3VtbWFyeS5maW5kKHN1bSA9PiBzdW0uaWQgPT09ICdqc3gnKSFcbiAgY29uc3QganN4U3dpdGNoID0gY3JlYXRlU2VsZWN0KGpzeC5kaXNwbGF5LCAnanN4JywganN4Lm9uZWxpbmVyLCBzYW5kYm94LCBtb25hY28ubGFuZ3VhZ2VzLnR5cGVzY3JpcHQuSnN4RW1pdClcbiAgZHJvcGRvd25Db250YWluZXIuYXBwZW5kQ2hpbGQoanN4U3dpdGNoKVxuXG4gIGNvbnN0IG1vZFN1bSA9IG9wdGlvbnNTdW1tYXJ5LmZpbmQoc3VtID0+IHN1bS5pZCA9PT0gJ21vZHVsZScpIVxuICBjb25zdCBtb2R1bGVTd2l0Y2ggPSBjcmVhdGVTZWxlY3QoXG4gICAgbW9kU3VtLmRpc3BsYXksXG4gICAgJ21vZHVsZScsXG4gICAgbW9kU3VtLm9uZWxpbmVyLFxuICAgIHNhbmRib3gsXG4gICAgbW9uYWNvLmxhbmd1YWdlcy50eXBlc2NyaXB0Lk1vZHVsZUtpbmRcbiAgKVxuICBkcm9wZG93bkNvbnRhaW5lci5hcHBlbmRDaGlsZChtb2R1bGVTd2l0Y2gpXG59XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVDb25maWdEcm9wZG93bkZvckNvbXBpbGVyT3B0aW9ucyA9IChzYW5kYm94OiBTYW5kYm94LCBtb25hY286IE1vbmFjbykgPT4ge1xuICBjb25zdCBjb21waWxlck9wdHMgPSBzYW5kYm94LmdldENvbXBpbGVyT3B0aW9ucygpXG4gIGNvbnN0IGJvb2xPcHRpb25zID0gT2JqZWN0LmtleXMoY29tcGlsZXJPcHRzKS5maWx0ZXIoayA9PiB0eXBlb2YgY29tcGlsZXJPcHRzW2tdID09PSAnYm9vbGVhbicpXG5cbiAgYm9vbE9wdGlvbnMuZm9yRWFjaChvcHQgPT4ge1xuICAgIGNvbnN0IGlucHV0SUQgPSAnb3B0aW9uLScgKyBvcHRcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SUQpIGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICBpbnB1dC5jaGVja2VkID0gISFjb21waWxlck9wdHNbb3B0XVxuICB9KVxuXG4gIGNvbnN0IGNvbXBpbGVySURUb01hcHM6IGFueSA9IHtcbiAgICBtb2R1bGU6IG1vbmFjby5sYW5ndWFnZXMudHlwZXNjcmlwdC5Nb2R1bGVLaW5kLFxuICAgIGpzeDogbW9uYWNvLmxhbmd1YWdlcy50eXBlc2NyaXB0LkpzeEVtaXQsXG4gICAgdGFyZ2V0OiBtb25hY28ubGFuZ3VhZ2VzLnR5cGVzY3JpcHQuU2NyaXB0VGFyZ2V0LFxuICB9XG5cbiAgT2JqZWN0LmtleXMoY29tcGlsZXJJRFRvTWFwcykuZm9yRWFjaChmbGFnSUQgPT4ge1xuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXBpbGVyLXNlbGVjdC0nICsgZmxhZ0lEKSBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgY29uc3QgY3VycmVudFZhbHVlID0gY29tcGlsZXJPcHRzW2ZsYWdJRF1cbiAgICBjb25zdCBtYXAgPSBjb21waWxlcklEVG9NYXBzW2ZsYWdJRF1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgcmVhbFZhbHVlID0gbWFwW2N1cnJlbnRWYWx1ZV1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZm9yIChjb25zdCBvcHRpb24gb2YgaW5wdXQuY2hpbGRyZW4pIHtcbiAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG9wdGlvbi52YWx1ZS50b0xvd2VyQ2FzZSgpID09PSByZWFsVmFsdWUudG9Mb3dlckNhc2UoKVxuICAgIH1cbiAgfSlcbn1cblxuY29uc3QgY3JlYXRlU2VsZWN0ID0gKHRpdGxlOiBzdHJpbmcsIGlkOiBzdHJpbmcsIGJsdXJiOiBzdHJpbmcsIHNhbmRib3g6IFNhbmRib3gsIG9wdGlvbjogYW55KSA9PiB7XG4gIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKVxuICBjb25zdCB0ZXh0VG9EZXNjcmliZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICB0ZXh0VG9EZXNjcmliZS50ZXh0Q29udGVudCA9IHRpdGxlICsgJzonXG4gIGxhYmVsLmFwcGVuZENoaWxkKHRleHRUb0Rlc2NyaWJlKVxuXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpXG4gIHNlbGVjdC5pZCA9ICdjb21waWxlci1zZWxlY3QtJyArIGlkXG4gIGxhYmVsLmFwcGVuZENoaWxkKHNlbGVjdClcblxuICBzZWxlY3Qub25jaGFuZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSBzZWxlY3QudmFsdWUgLy8gdGhlIGh1bWFuIHN0cmluZ1xuICAgIGNvbnN0IGNvbXBpbGVySW5kZXggPSBvcHRpb25bdmFsdWVdXG4gICAgc2FuZGJveC51cGRhdGVDb21waWxlclNldHRpbmcoaWQsIGNvbXBpbGVySW5kZXgpXG4gIH1cblxuICBPYmplY3Qua2V5cyhvcHRpb24pXG4gICAgLmZpbHRlcihrZXkgPT4gaXNOYU4oTnVtYmVyKGtleSkpKVxuICAgIC5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAvLyBoaWRlIExhdGVzdFxuICAgICAgaWYgKGtleSA9PT0gJ0xhdGVzdCcpIHJldHVyblxuXG4gICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKVxuICAgICAgb3B0aW9uLnZhbHVlID0ga2V5XG4gICAgICBvcHRpb24udGV4dCA9IGtleVxuXG4gICAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKVxuICAgIH0pXG5cbiAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICBzcGFuLnRleHRDb250ZW50ID0gYmx1cmJcbiAgc3Bhbi5jbGFzc0xpc3QuYWRkKCdjb21waWxlci1mbGFnLWJsdXJiJylcbiAgbGFiZWwuYXBwZW5kQ2hpbGQoc3BhbilcblxuICByZXR1cm4gbGFiZWxcbn1cblxuZXhwb3J0IGNvbnN0IHNldHVwSlNPTlRvZ2dsZUZvckNvbmZpZyA9IChzYW5kYm94OiBTYW5kYm94KSA9PiB7fVxuIl19